!function(e){e.fn.idleTimeout=function(i){var t,o,n,l,a,s,r,d,c,u,g,m,f,v,p,T,w,b,y,L,h={redirectUrl:"/logout",idleTimeLimit:1200,idleCheckHeartbeat:2,customCallback:!1,activityEvents:"click keypress scroll wheel mousewheel mousemove",enableDialog:!0,dialogDisplayLimit:180,dialogTitle:"Session Expiration Warning",dialogText:"Because you have been inactive, your session is about to expire.",dialogTimeRemaining:"Time remaining",dialogStayLoggedInButton:"Stay Logged In",dialogLogOutNowButton:"Log Out Now",errorAlertMessage:'Please disable "Private Mode", or upgrade to a modern browser. Or perhaps a dependent file missing. Please see: https://github.com/marcuswestin/store.js',sessionKeepAliveTimer:600,sessionKeepAliveUrl:window.location.href},A=e.extend(h,i),k=document.title;return this.logout=function(){store.set("idleTimerLoggedOut",!0)},o=function(){l=function(){e.get(A.sessionKeepAliveUrl),o()},a=setTimeout(l,1e3*A.sessionKeepAliveTimer)},n=function(){clearTimeout(a)},t=function(){e("body").on(A.activityEvents,function(){(!A.enableDialog||A.enableDialog&&!0!==w())&&u()})},d=function(){var i=store.get("idleTimerLastActivity")+1e3*A.idleTimeLimit;e.now()>i?A.enableDialog?A.enableDialog&&!0!==w()&&(m(),p()):L():!0===store.get("idleTimerLoggedOut")?L():A.enableDialog&&!0===w()&&(b(),T())},u=function(){g(),store.set("idleTimerLastActivity",e.now()),c()},c=function(){d(),s=setTimeout(c,1e3*A.idleCheckHeartbeat)},g=function(){clearTimeout(s)},m=function(){var i="<div id='idletimer_warning_dialog'><p>"+A.dialogText+"</p><p style='display:inline'>"+A.dialogTimeRemaining+": <div style='display:inline' id='countdownDisplay'></div></p></div>";if("Notification"in window){var t=A.dialogText;Notification.permission="granted",function(e){var i={body:e,icon:"../../Content/images/logo_big_2.png"},t=new Notification("Session Expiration Warning",i);t.onclick=function(){window.focus(window.location.href)},setTimeout(function(){t.close()},1e4)}(t)}else alert("This browser does not support desktop notification");e(i).dialog({buttons:[{text:A.dialogStayLoggedInButton,click:function(){b(),T(),u()}},{text:A.dialogLogOutNowButton,click:function(){L()}}],closeOnEscape:!1,modal:!0,title:A.dialogTitle,open:function(){e(this).closest(".ui-dialog").find(".ui-dialog-titlebar-close").hide()}}),y(),document.title=A.dialogTitle,A.sessionKeepAliveTimer&&n()},v=function(){var i=store.get("idleTimerLastActivity")+1e3*A.idleTimeLimit+1e3*A.dialogDisplayLimit;(e.now()>i||!0===store.get("idleTimerLoggedOut"))&&L()},p=function(){f=setInterval(v,1e3*A.idleCheckHeartbeat)},T=function(){clearInterval(f),clearInterval(r)},w=function(){return!0===e("#idletimer_warning_dialog").is(":visible")},b=function(){e("#idletimer_warning_dialog").dialog("destroy").remove(),document.title=k,A.sessionKeepAliveTimer&&o()},y=function(){var i,t,o=A.dialogDisplayLimit;r=setInterval(function(){(i=Math.floor(o/60))<10&&(i="0"+i),(t=o-60*i)<10&&(t="0"+t),e("#countdownDisplay").html(i+":"+t),o-=1},1e3)},L=function(){store.set("idleTimerLoggedOut",!0),A.sessionKeepAliveTimer&&n(),A.customCallback&&A.customCallback(),A.redirectUrl&&(window.location.href=A.redirectUrl)},this.each(function(){store.enabled?(store.set("idleTimerLastActivity",e.now()),store.set("idleTimerLoggedOut",!1),t(),A.sessionKeepAliveTimer&&o(),u()):alert(A.errorAlertMessage)})}}(jQuery);